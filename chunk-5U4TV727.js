import{a as _e}from"./chunk-HY74IRL2.js";import{A as C,Aa as V,Ba as O,Ca as L,D as p,Da as P,E as i,Ea as ve,F as r,Fa as he,G as h,Ga as Ne,H as N,Ha as Se,I as d,Ia as x,J as f,K as w,Ka as Ce,L as R,M as k,N as W,O as m,P as y,Q as X,S as U,U as Y,V as ee,W as te,X as oe,f as M,ga as Z,ha as ie,ia as ne,ja as z,ka as re,la as ae,m as K,ma as me,n as b,na as se,oa as ce,p as I,pa as le,qa as pe,ra as de,s as u,sa as E,t as g,ua as fe,va as _,w as c,wa as A,x as s,xa as ue,y as l,ya as ge,z as T,za as j}from"./chunk-XVE5IWEF.js";var v=class o{constructor(t,e,n){this.socket=t;this.authService=e;this.http=n}url=`${de.apiUrl}/notes`;watchNotes(){return this.socket.fromEvent(this.authService.token)}getNotes(){return M(this.http.get(this.url,{headers:this.authService.authHeaders}))}addNote(t){return M(this.http.post(this.url,t,{headers:this.authService.authHeaders}))}editNote(t,e){return M(this.http.put(`${this.url}/${t}`,e,{headers:this.authService.authHeaders}))}deleteNote(t){return M(this.http.delete(`${this.url}/${t}`,{headers:this.authService.authHeaders}))}static \u0275fac=function(e){return new(e||o)(I(_e),I(ie),I(oe))};static \u0275prov=K({token:o,factory:o.\u0275fac,providedIn:"root"})};var F=class o{constructor(t){this.formBuilder=t}noteForm;editMode=!1;note=null;ngOnInit(){this.noteForm=this.buildNoteForm(),this.editMode&&this.noteForm.setValue({title:this.note?.title,content:this.note?.content})}buildNoteForm(){return this.formBuilder.group({title:["",z.required],content:["",z.required]})}static \u0275fac=function(e){return new(e||o)(s(le))};static \u0275cmp=l({type:o,selectors:[["app-note-form"]],inputs:{editMode:"editMode",note:"note"},standalone:!1,decls:13,vars:1,consts:[[1,"d-flex","flex-column","align-items-center",3,"formGroup"],["matInput","","formControlName","title"],["matInput","","formControlName","content"]],template:function(e,n){e&1&&(i(0,"form",0)(1,"mat-form-field")(2,"mat-label"),m(3,"Tytu\u0142"),r(),h(4,"input",1),i(5,"mat-error"),m(6,"Pole wymagane!"),r()(),i(7,"mat-form-field")(8,"mat-label"),m(9,"Zawarto\u015B\u0107"),r(),h(10,"textarea",2),i(11,"mat-error"),m(12,"Pole wymagane!"),r()()()),e&2&&p("formGroup",n.noteForm)},dependencies:[Ne,ve,he,Se,me,ne,re,ae,se,ce],styles:["form[_ngcontent-%COMP%]{gap:10px}"]})};var Te=["noteFormRef"],Q=class o{constructor(t,e,n,a){this.toastService=t;this.notesService=e;this.dialogRef=n;this.loadingService=a}noteFormRef;addNote(){this.noteFormRef.noteForm.markAllAsTouched(),this.noteFormRef.noteForm.valid&&(this.loadingService.changeLoadingState(!0),this.notesService.addNote(this.noteFormRef.noteForm.value).then(()=>{this.dialogRef.close(),this.toastService.openSuccessToast("Dodano notk\u0119!")}).catch(t=>{this.toastService.openErrorFromApiToast(t)}).finally(()=>this.loadingService.changeLoadingState(!1)))}static \u0275fac=function(e){return new(e||o)(s(_),s(v),s(A),s(P))};static \u0275cmp=l({type:o,selectors:[["app-add-note-dialog"]],viewQuery:function(e,n){if(e&1&&w(Te,5),e&2){let a;R(a=k())&&(n.noteFormRef=a.first)}},standalone:!1,decls:13,vars:0,consts:[["noteFormRef",""],[1,"d-flex","flex-column","align-items-center"],["mat-dialog-title",""],["mat-icon-button","",3,"click"],["mat-icon-button","","mat-dialog-close",""]],template:function(e,n){if(e&1){let a=N();i(0,"div",1)(1,"h3",2),m(2,"Dodaj notk\u0119"),r(),i(3,"mat-dialog-content"),h(4,"app-note-form",null,0),r(),i(6,"mat-dialog-actions")(7,"button",3),d("click",function(){return u(a),g(n.addNote())}),i(8,"mat-icon"),m(9,"note_add"),r()(),i(10,"button",4)(11,"mat-icon"),m(12,"cancel"),r()()()()}},dependencies:[E,j,V,L,O,x,F],encapsulation:2})};var Re=["noteFormRef"];function ke(o,t){if(o&1&&(i(0,"h1",7),m(1),r()),o&2){let e=f();c(),X(" ",e.note.title," ")}}function Ee(o,t){if(o&1&&(i(0,"div"),m(1),r()),o&2){let e=f();c(),y(e.note.content)}}function Ae(o,t){if(o&1&&h(0,"app-note-form",8,2),o&2){let e=f();p("editMode",!0)("note",e.note)}}function je(o,t){if(o&1){let e=N();i(0,"div")(1,"button",9),d("click",function(){u(e);let a=f();return g(a.editMode=!0)}),i(2,"mat-icon"),m(3,"mode_edit"),r()(),i(4,"button",9),d("click",function(){u(e);let a=f();return g(a.deleteNote())}),i(5,"mat-icon"),m(6,"delete_forever"),r()()()}}function Ve(o,t){if(o&1){let e=N();i(0,"button",9),d("click",function(){u(e);let a=f();return g(a.edit())}),i(1,"mat-icon"),m(2,"save"),r()(),i(3,"button",9),d("click",function(){u(e);let a=f();return g(a.editMode=!1)}),i(4,"mat-icon"),m(5,"cancel"),r()()}}var G=class o{constructor(t,e,n,a,D){this.note=t;this.notesService=e;this.toastService=n;this.dialogRef=a;this.loadingService=D}editMode=!1;noteFormRef;edit(){this.noteFormRef.noteForm.markAllAsTouched(),this.noteFormRef.noteForm.valid&&(this.loadingService.changeLoadingState(!0),this.notesService.editNote(this.note.id,this.noteFormRef.noteForm.value).then(()=>{let t=this.noteFormRef.noteForm.value;t.id=this.note.id,this.note=t,this.toastService.openSuccessToast("Notka wyedytowana!"),this.editMode=!1}).catch(t=>this.toastService.openErrorFromApiToast(t)).finally(()=>this.loadingService.changeLoadingState(!1)))}deleteNote(){this.loadingService.changeLoadingState(!0),this.notesService.deleteNote(this.note.id).then(()=>{this.toastService.openSuccessToast("Notka usuni\u0119ta!"),this.dialogRef.close()}).catch(t=>this.toastService.openErrorFromApiToast(t)).finally(()=>this.loadingService.changeLoadingState(!1))}static \u0275fac=function(e){return new(e||o)(s(ue),s(v),s(_),s(A),s(P))};static \u0275cmp=l({type:o,selectors:[["app-note-dialog"]],viewQuery:function(e,n){if(e&1&&w(Re,5),e&2){let a;R(a=k())&&(n.noteFormRef=a.first)}},standalone:!1,decls:13,vars:5,consts:[["editForm",""],["editControls",""],["noteFormRef",""],["id","dialog",1,"d-flex","flex-column","align-items-center"],["mat-icon-button","","mat-dialog-close","",1,"align-self-end","me-2","mt-2"],["mat-dialog-title","",4,"ngIf"],[4,"ngIf","ngIfElse"],["mat-dialog-title",""],[3,"editMode","note"],["mat-icon-button","",3,"click"]],template:function(e,n){if(e&1&&(i(0,"div",3)(1,"button",4)(2,"mat-icon"),m(3,"close"),r()(),C(4,ke,2,1,"h1",5),i(5,"mat-dialog-content"),C(6,Ee,2,1,"div",6)(7,Ae,2,2,"ng-template",null,0,U),r(),i(9,"mat-dialog-actions"),C(10,je,7,0,"div",6)(11,Ve,6,0,"ng-template",null,1,U),r()()),e&2){let a=W(8),D=W(12);c(4),p("ngIf",!n.editMode),c(2),p("ngIf",!n.editMode)("ngIfElse",a),c(4),p("ngIf",!n.editMode)("ngIfElse",D)}},dependencies:[ee,E,j,V,L,O,x,F],encapsulation:2})};var H=class o{note;static \u0275fac=function(e){return new(e||o)};static \u0275cmp=l({type:o,selectors:[["app-note-card"]],inputs:{note:"note"},standalone:!1,decls:5,vars:2,consts:[[1,"d-flex","flex-column","align-items-center","pt-3"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"h1"),m(2),r(),i(3,"p"),m(4),r()()),e&2&&(c(2),y(n.note.title),c(2),y(n.note.content.length>20?n.note.content.substring(0,20)+"...":n.note.content))},styles:["div[_ngcontent-%COMP%]{border:2px solid var(--mat-sys-primary);border-radius:5px;transition:.15s}div[_ngcontent-%COMP%]:hover{background:var(--mat-sys-primary-container)}"],changeDetection:0})};function Le(o,t){if(o&1){let e=N();i(0,"app-note-card",3),d("click",function(){let a=u(e).$implicit,D=f();return g(D.openNoteDialog(a))}),r()}if(o&2){let e=t.$implicit;p("note",e)}}var $=class o{constructor(t,e,n){this.notesService=t;this.toastService=e;this.dialog=n}notesWatcherSubscription;notes;ngOnInit(){this.notesWatcherSubscription=this.notesService.watchNotes().subscribe(t=>this.notes=t),this.notesService.getNotes().then(t=>{this.notes=t}).catch(t=>this.toastService.openErrorFromApiToast(t))}openNoteDialog(t){this.dialog.open(G,{data:t})}openAddNoteDialog(){this.dialog.open(Q)}ngOnDestroy(){this.notesWatcherSubscription.unsubscribe()}static \u0275fac=function(e){return new(e||o)(s(v),s(_),s(ge))};static \u0275cmp=l({type:o,selectors:[["app-notes"]],standalone:!1,decls:5,vars:1,consts:[["id","notes",1,"d-flex","flex-column","m-2"],[3,"note","click",4,"ngFor","ngForOf"],["mat-fab","","id","add-note-btn",3,"click"],[3,"click","note"]],template:function(e,n){e&1&&(i(0,"div",0),C(1,Le,1,1,"app-note-card",1),r(),i(2,"button",2),d("click",function(){return n.openAddNoteDialog()}),i(3,"mat-icon"),m(4,"note_add"),r()()),e&2&&(c(),p("ngForOf",n.notes))},dependencies:[Y,fe,x,H],styles:["app-note-card[_ngcontent-%COMP%]{cursor:pointer}#notes[_ngcontent-%COMP%]{gap:10px}#add-note-btn[_ngcontent-%COMP%]{position:fixed;bottom:30px;right:30px}"]})};var Pe=[{path:"",pathMatch:"full",component:$}],q=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=T({type:o});static \u0275inj=b({imports:[Z.forChild(Pe),Z]})};var be=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=T({type:o});static \u0275inj=b({imports:[te,q,Ce,pe]})};export{be as NotesModule};
